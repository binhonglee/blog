<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Test Driven Development with Alexa SDK - The Ink Mortar</title><meta name=description content="What is Test Driven Development? According to Wikipedia, it means “Requirements are turned into very specific test cases, then the software is improved to pass the new tests, only.” Basically, you would first have to write the test of the software/feature you are developing before you start working on the developing the software/feature itself.
Here are a few more articles on the benefits and why you should apply TDD:
 Test Driven Development by Jan Olbrich Isn’t TDD twice the work?"><meta name=author content="BinHong Lee"><link href=https://binhong.me/blog/an-old-hope.min.css rel=stylesheet><link href=https://binhong.me/blog/style.css rel=stylesheet><link href=https://binhong.me/blog/custom.css rel=stylesheet><link rel=icon href=https://binhong.me/blog/img/profile.png><meta name=generator content="Hugo 0.85.0"><script>const key='dark-theme',dark='dark',light='light';function setTheme(){localStorage.getItem(key)?localStorage.getItem(key)===dark&&document.body.classList.add(dark):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add(dark)}function toggleDarkMode(){const b=localStorage.getItem(key);var a=dark;b===a&&(a=light),localStorage.setItem(key,a),document.body.classList.toggle(dark)}</script></head><body class=single><script>setTheme()</script><header class=header><nav class=nav><h1 class=logo><a href=https://binhong.me/blog/>The Ink Mortar</a></h1><button class=dark-mode-toggle onclick=toggleDarkMode()><h4 class=bright-text>Bright</h2><h4 class=dark-text>Dark</h2></button></nav></header><main class=main><article class=post-single><a href=https://binhong.me/blog/img/alexa.jpeg><img class=post-thumbnail-img src=https://binhong.me/blog/img/alexa.jpeg></a><div class=post-single-content><header class=post-header><h1 class=post-title>Test Driven Development with Alexa SDK</h1><h2 class=post-subtitle>Quick guide to building and unit testing an Alexa Skill</h2><div class=post-meta>BinHong Lee · October 29, 2018</div></header><div class=post-content><h1 id=what-is-test-driven-development>What is Test Driven Development?</h1><p>According to <a href=https://en.wikipedia.org/wiki/Test-driven_development>Wikipedia</a>, it means “Requirements are turned into very specific <a href=https://en.wikipedia.org/wiki/Test_case>test cases</a>, then the software is improved to pass the new tests, only.” Basically, you would first have to write the test of the software/feature you are developing before you start working on the developing the software/feature itself.</p><p>Here are a few more articles on the benefits and why you should apply TDD:</p><ul><li><a href=https://medium.com/mobile-quality/test-driven-development-d16fd216d45c>Test Driven Development</a> by Jan Olbrich</li><li><a href=https://hackernoon.com/test-driven-development-with-alexa-sdk-777f6b5e5486>Isn’t TDD twice the work? Why should you care?</a> by Navdeep Singh</li></ul><h1 id=preparation>Preparation</h1><p>Here are a few thing you might want to have set up or installed before getting started:</p><ul><li><a href=https://aws.amazon.com/>Amazon Web Service</a> account (a free one will work just fine)</li><li><a href=https://nodejs.org/en/>node.js</a> (personally though, I prefer installing and maintaining it through <a href=https://github.com/creationix/nvm>nvm</a>)</li><li>Text editor of your choice</li></ul><h1 id=setting-up>Setting up</h1><ol><li>Create a new project folder (<code>mkdir project-name</code>)</li><li>Navigate into that new folder (<code>cd project-name</code>)</li><li>Initialize npm (<code>npm init</code>)</li><li>Follow through everything as you prefer (if you don’t know what it is, just press enter and it’ll keep the default) except for test command:, put in node test/testflow.js instead. The command line should look something like the snippet below.</li></ol><pre><code>This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.
See `npm help json` for definitive documentation on these fields
and exactly what they do.
Use `npm install &lt;pkg&gt;` afterwards to install a package and
save it as a dependency in the package.json file.
Press ^C at any time to quit.
package name: (emptyproject) 
version: (1.0.0) 
description: 
entry point: (index.js) 
test command: node test/testflow.js
git repository: 
keywords: 
author: 
license: (ISC)
</code></pre><p>Now you have node.js setup for the project.</p><p>Unit testing
Shout out to <a href=https://twitter.com/robmccauley>robmccauley</a> for maintaining <a href=https://github.com/robm26/testflow>testflow</a> that provides unit testing for Alexa skills. Here’s what the following commands will do :</p><ul><li>Clone testflow repository into your project at the ‘test’ folder. (If this project is also a git project itself, I recommend doing <code>git submodule add</code> instead of <code>git clone</code>.)</li><li>Create a folder named ‘dialogs’</li><li>Create a file named ‘default.txt’ in the ‘dialog’ folder</li><li>Edit the ‘SourceCodeFile’ line in the cloned ‘testflow’ repository to point to the ‘index.js’ in the base level of the folder (feel free to edit it to your personal preference).</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>git clone git@github.com:robm26/testflow.git test
mkdir dialogs
touch dialogs/default.txt
sed -i <span style=color:#e6db74>&#39;9c const SourceCodeFile = &#34;../index.js&#34;&#39;</span> test/testflow.js
</code></pre></div><p>Inside the ‘default.txt’ file in the ‘dialogs’ folder, you should have the intents you are trying to test. The default in the testflow repository consist of the followings but you should definitely add some more customized ones to it depending on what you are trying to do in your skill.</p><pre><code>LaunchRequest
AMAZON.HelpIntent
AMAZON.StopIntent
</code></pre><p>In case where you are taking in variables through utterances, you can do something like this :</p><pre><code>DoSomething Input1=userInput1 Input2=userInput2
</code></pre><p>To get a deeper understanding into using testflow, I recommend looking into its <a href=https://github.com/robm26/testflow/blob/master/tutorial/TUTORIAL.md>tutorial page</a> and the <a href=https://developer.amazon.com/blogs/alexa/post/35eb8ae8-2cd8-4de7-86c5-97a1abc239b9/testflow-simulate-conversations-with-your-alexa-skill-code-to-ease-debugging>blog post</a> by the author himself.</p><h1 id=developing-the-skill>Developing the skill</h1><p>To be honest, I don’t have too much to talk about on this topic. Here is some sample code of how a sample skill can look like. (Also remember to do <code>npm install --save alexa-sdk</code>.)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>Alexa</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;alexa-sdk&#39;</span>)

<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>handler</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>context</span>, <span style=color:#a6e22e>callback</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>alexa</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Alexa</span>.<span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>context</span>)
  <span style=color:#a6e22e>alexa</span>.<span style=color:#a6e22e>registerHandlers</span>(<span style=color:#a6e22e>handlers</span>)
  <span style=color:#a6e22e>alexa</span>.<span style=color:#a6e22e>execute</span>()
}

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>handlers</span> <span style=color:#f92672>=</span> {
  <span style=color:#e6db74>&#39;LaunchRequest&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;:ask&#39;</span>, <span style=color:#e6db74>&#39;Welcome to the sample skill. Say help for help.&#39;</span>)
  },
  
  <span style=color:#e6db74>&#39;Intent1&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;:ask&#39;</span>, <span style=color:#e6db74>&#39;This is the first intent.&#39;</span>)
  },
  
  <span style=color:#e6db74>&#39;Intent2&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>input1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>intent</span>.<span style=color:#a6e22e>slots</span>.<span style=color:#a6e22e>InputOne</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>toString</span>()
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>input2</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>intent</span>.<span style=color:#a6e22e>slots</span>.<span style=color:#a6e22e>InputTwo</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>toString</span>()
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>doSomething</span>(<span style=color:#a6e22e>input1</span>, <span style=color:#a6e22e>input2</span>)
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;:ask&#39;</span>, <span style=color:#a6e22e>response</span>)
  },

  <span style=color:#e6db74>&#39;AMAZON.HelpIntent&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;:ask&#39;</span>, <span style=color:#e6db74>&#39;Insert some help message here.&#39;</span>)
  },

  <span style=color:#e6db74>&#39;AMAZON.StopIntent&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;:tell&#39;</span>, <span style=color:#e6db74>&#39;Have a good rest of your day!&#39;</span>)
  }
}

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>doSomething</span> (<span style=color:#a6e22e>input1</span>, <span style=color:#a6e22e>input2</span>) {
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>input1</span>.<span style=color:#a6e22e>localeCompare</span>(<span style=color:#a6e22e>input2</span>)) {
    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;They are the same string!&#34;</span>
  } <span style=color:#66d9ef>else</span> {
    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;They are different!&#34;</span>
  }
}
</code></pre></div><p>I recommend looking into the official <a href=https://github.com/alexa/alexa-cookbook>Alexa GitHub repository</a> that provides all kinds of sample skills that you can work on top of.</p><h1 id=deployment>Deployment</h1><h2 id=alexa-skill-kit>Alexa Skill Kit</h2><p>Go to <a href=https://developer.amazon.com/alexa/console/>this page</a> and select ‘Create Skill’. In there you should see options to ‘add intents’ and ‘custom slot types’. You should add the appropriate slot types and intents accordingly from above. After you are done with that, select ‘Endpoint’ from the side bar and select ‘AWS Lambda ARN’ as the skill’s service endpoint. Make a copy of the Skill ID as you will need it later.</p><h2 id=aws-lambda>AWS Lambda</h2><p>Create an AWS Lambda function selecting ‘from scratch’. After that, you should have an option to ‘add trigger’ where you would select ‘Alexa Skills Kit’. Now in the configuration dialog, you should put in the Skill ID you took a copy of previously then select ‘Add’.</p><p>After this, select back to the box that labeled your project name. There should be a ‘Function code’ dialog box appeared below. While you can definitely copy and paste your code onto the online text editor, there might be chance where the packages you have installed and used in your code is included by default. It is also possible that you have more than 1 JavaScript files for the skill.</p><p>In this case, you would select ‘Upload a .ZIP file’ under ‘Code entry type’. Locally, zip up all the JavaScript files along with the <code>node_modules</code> folder then upload the resulting zip file.</p><h2 id=submission>Submission</h2><p>When you are done, you can go back to the Alexa Skill Kit page, select the ‘Distribution’ tab and fill out the appropriate information before submitting your skill for review. Hopefully everything goes well and your skill gets published at the Alexa Skill Store!</p><hr><h2 id=about-me>About me</h2><p>I recently started working at Facebook as a Software Engineer. I spend a lot of my free time experimenting and building new things with technologies I find fun and interesting. Follow my exploration journey <a href=https://binhong.me/blog>here</a> or on <a href=https://github.com/binhonglee>GitHub</a>.</p><hr><h2 id=credits>Credits</h2><ul><li><a href=https://developer.amazon.com/docs/ask-overviews/build-skills-with-the-alexa-skills-kit.html>Build Skills with the Alexa Skills Kit</a></li><li><a href=https://developer.amazon.com/blogs/alexa/post/35eb8ae8-2cd8-4de7-86c5-97a1abc239b9/testflow-simulate-conversations-with-your-alexa-skill-code-to-ease-debugging>TestFlow: Simulate Conversations with Your Alexa Skill Code to Ease Debugging</a></li></ul><blockquote><p><em>This article was originally published on <a href=https://hackernoon.com/test-driven-development-with-alexa-sdk-777f6b5e5486>Hackernoon</a>.</em></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://binhong.me/blog/tags/javascript>JavaScript</a></li><li><a href=https://binhong.me/blog/tags/alexa>Alexa</a></li><li><a href=https://binhong.me/blog/tags/alexa-skills>Alexa Skills</a></li><li><a href=https://binhong.me/blog/tags/tdd>Tdd</a></li><li><a href=https://binhong.me/blog/tags/alexa-sdk>Alexa Sdk</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://binhong.me/blog/>The Ink Mortar</a> by BinHong Lee</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</span>
<span>&#183;</span>
<span>Theme️ <a href=https://github.com/binhonglee/CustomPaper rel=noopener target=_blank>CustomPaper</a></span></footer><script src=https://binhong.me/blog/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></body></html>