<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=0.75">
    
    <title>Automated Link Preview Image Card - BinHong Lee&#39;s Blog</title>
    
    <meta name="description" content="A while ago, I saw this tweet thread from Simon Willison about how he added social media preview cards to his TILs. He detailed how he did this through a combination of Puppeteer, Vercel, SQLite, and some other stuff I didn&rsquo;t understand üòÖ.
At that time, I was manually taking these screenshots by hand to be included as part of the commit, which is to say it&rsquo;s not very efficient. Anyway, this stayed on my backlog of &ldquo;things to explore&rdquo; for a really long time until recently during this long weekend (where I also took additional PTOs), I had some free time and decided to look into this. The goal is simple, automate creating the preview images for a list of given / defined urls.">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Automated Link Preview Image Card">
    <meta property="og:description" content="Taking screenshots with Playwright">
    <meta name="twitter:description" content="Taking screenshots with Playwright">
    <meta name="twitter:title" content="Automated Link Preview Image Card"><meta property="article:published_time" 2022-05-31T00:00:00-08:00 />
    <meta property="article:modified_time" 2022-05-31T00:00:00-08:00 />
    <meta property="og:image" content="https://binhong.me/blog/preview/automated_link_preview.jpg">
    <meta property="og:image:height" content="600">
    <meta property="og:image:width" content="1200">
    <meta name="twitter:image" content="https://binhong.me/blog/preview/automated_link_preview.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="max-image-preview:large">
    <meta name="image" content="https://binhong.me/blog/preview/automated_link_preview.jpg" />
    <meta name="twitter:site" content="@">
    <meta name="author" content="BinHong Lee">
    <meta property="og:profile:first_name" content="BinHong">
    <meta property="og:profile:last_name" content="Lee">
    <meta property="og:username" content="binhong">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="BinHong Lee&#39;s Blog">
    <meta name="twitter:site" content="@binhonglee">
    <meta name="fediverse:creator" content="@bh@social.lol">
    <link href="https://social.lol/@bh" rel="me">
    
    <link href="https://binhong.me/blog/style.css?v=1759946748080" rel="stylesheet">
    <link href="https://binhong.me/blog/darkMode.css?v=1754287594183" rel="stylesheet">
    <link href="https://binhong.me/blog/dark-syntax.css?v=1754290957202" rel="stylesheet">
    <link href="https://binhong.me/blog/light-syntax.css?v=1754290957202" rel="stylesheet">
    <link href="https://binhong.me/fonts/fonts.css?v=1761449005615" rel="stylesheet">
    <link href="https://binhong.me/threads/threads.css" rel="stylesheet">
    
    
    <link rel="icon" href="https://binhong.me/blog/img/profile.png" />
    
    <meta name="generator" content="Hugo 0.152.2">
    
    </head>
  <body class="single">
    <input class="dark_mode_toggle" type="checkbox" id="darkModeToggle">
    <div class="wrapper">
      <div class="content">
        <div class="dropdown">
          <button class="dropdown_toggle" aria-haspopup="true" aria-controls="dropdown_menu">+</button>
          <div class="header_links" id="dropdown_menu" aria-labelledby="dropdown_toggle" role="menu">
            <a class="link" href="https://binhong.me/" role="menuitem">About</a>
            <p>|</p>
            <a class="link" href="https://binhong.me/blog/" role="menuitem">Blog</a>
            <p>|</p>
            <div class="webring link" role="menuitem">
              <a class="webring_toggle">Webring</a>
              <div class="webring_links">
                <a class="link" href="https://ringdt.rapid.workers.dev/prev?from=https://binhong.me">Prev</a>
                <hr />
                <a class="link" href="https://ringdt.rapid.workers.dev/next?from=https://binhong.me">Next</a>    
              </div>
            </div>
          </div>
        </div>
        <div class="page_of_title">
          <div class="secondary_block">
            <p class="name-title">Blog</p>
          </div>
        </div>
        <div class="dark_mode_toggle_wrapper">
          <div class="toggle-container">
            <label for="darkModeToggle" class="toggle-label">
              <div class="background-layer day-bg"></div>
              <div class="background-layer night-bg"></div>
              
              <div class="toggle-slider">
                <div class="sun-rays"></div>
                <div class="moon-craters">
                  <div class="crater"></div>
                  <div class="crater"></div>
                  <div class="crater"></div>
                </div>
              </div>
              
              <div class="cloud cloud1"></div>
              <div class="cloud cloud2"></div>
              <div class="cloud cloud3"></div>
              <div class="cloud cloud4"></div>
              <div class="cloud cloud5"></div>
              
              <div class="star star1"></div>
              <div class="star star2"></div>
              <div class="star star3"></div>
              <div class="star star4"></div>
              <div class="star star5"></div>
              <div class="star star6"></div>
              <div class="star star7"></div>
              <div class="star star8"></div>
              <div class="star star9"></div>
              <div class="star star10"></div>
              <div class="star star11"></div>
              <div class="star star12"></div>
            </label>
          </div>
        </div>
      </div>


    <article class="content_body primary_block projects">
      <main class="article_body">
        <div class="active">
          <h1 class="row title">Automated Link Preview Image Card</h1>
          <p class="row subtitle">Taking screenshots with Playwright</p>
          <div class="row author">
            <p>BinHong Lee</p>
            <p class="right">May 31, 2022</p>
          </div>
          <div class="post_content"><p>A while ago, I saw <a href="https://twitter.com/simonw/status/1300868423774212096">this tweet thread from Simon Willison</a> about how he added social media preview cards to his TILs. He detailed how he did this through a combination of Puppeteer, Vercel, SQLite, and some other stuff I didn&rsquo;t understand üòÖ.</p>
<p>At that time, I was manually taking these screenshots by hand to be included as part of the commit, which is to say it&rsquo;s not very efficient. Anyway, this stayed on my backlog of &ldquo;things to explore&rdquo; for a really long time until recently during this long weekend (where I also took additional PTOs), I had some free time and decided to look into this. The goal is simple, automate creating the preview images for a list of given / defined urls.</p>
<a class="anchor" href="#playwright">
    <h2 id="playwright">
        <span class="text">Playwright</span>
        <span class="tag">#</span>
    </h2>
</a>
<p>I know I just mentioned above that Simon used Puppeteer for his implementation but I just recently picked up Playwright for another project (<a href="https://globetrotte.com">GlobeTrotte</a>) and figured that it seems like the right tool for this. Also, Playwright has better TypeScript support in general so I decided to opt for Playwright instead. (If you didn&rsquo;t know, Playwright is built by the same team of engineers who built Puppeteer but has somehow all moved over from Google to Microsoft to build Playwright. There were some uhh interesting discussions about this when Playwright was first announced publicly.)</p>
<p>The minimum code needed for a working version is pretty short. It looks something like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">chromium</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;playwright-core&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">genRun</span><span class="p">()</span><span class="o">:</span> <span class="nx">Promise</span><span class="p">&lt;</span><span class="nt">void</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">browser</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">chromium</span><span class="p">.</span><span class="nx">launch</span><span class="p">()</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">env</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">newContext</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">baseURL</span><span class="o">:</span> <span class="s2">&#34;http://localhost:1313/blog&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">viewport</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">width</span>: <span class="kt">1200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">height</span>: <span class="kt">600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">page</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">env</span><span class="p">.</span><span class="nx">newPage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="s2">&#34;/2022-05-31-automated-link-preview-image&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">waitForLoadState</span><span class="p">(</span><span class="s2">&#34;networkidle&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">screenshot</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">animations</span><span class="o">:</span> <span class="s2">&#34;disabled&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fullPage</span>: <span class="kt">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="kr">type</span><span class="o">:</span> <span class="s2">&#34;jpeg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">path</span><span class="o">:</span> <span class="s2">&#34;preview/automated_link_preview.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><a class="anchor" href="#globetrottealtimeter">
    <h2 id="globetrottealtimeter">
        <span class="text">@globetrotte/altimeter</span>
        <span class="tag">#</span>
    </h2>
</a>
<p>Since I might want to use this in multiple places, I figured it&rsquo;s probably a good idea to create <a href="https://www.npmjs.com/package/@globetrotte/altimeter">an npm package</a> for this so I can reuse it everywhere (with just some slight config change).</p>
<p>The package itself is really just a CLI tool for now. First, create a json config file based on <a href="https://github.com/binhonglee/GlobeTrotte/tree/main/src/altimeter#config">this doc</a> (depending on what you want from these screenshots). Then, run <code>npm i -g @globetrotte/altimeter &amp;&amp; altimeter config.json</code> and you should see the screenshots show up once the run is complete.</p>
<p><em>Note: Unfortunately straight up calling <code>npx @globetrotte/altimeter config.json</code> doesn&rsquo;t work as of now (unless you already have playwright installed before which can&rsquo;t be guaranteed) since it won&rsquo;t trigger the postinstall script to install playwright.</em></p>
<p>Alternatively, it can also be generated by including the package as a dependency, then import <code>AltimeterConfig</code> from the package, set the variables, and write the output to a JSON file. Something like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">AltimeterConfig</span><span class="p">,</span> <span class="nx">AltimeterDestination</span> <span class="p">}</span> <span class="kr">from</span> <span class="s2">&#34;@globetrotte/altimeter&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">genConfig</span><span class="p">(</span><span class="nx">urls</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AltimeterConfig</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nx">config</span><span class="p">.</span><span class="nx">baseURL</span> <span class="o">=</span> <span class="s2">&#34;http://localhost:1313/blog&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nx">config</span><span class="p">.</span><span class="nx">destURLs</span> <span class="o">=</span> <span class="nx">urls</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">url</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// You can also do some modification here to set a better &#34;name&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="k">new</span> <span class="nx">AltimeterDestination</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// This line is to add the index page itself (omit if not needed)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">config</span><span class="p">.</span><span class="nx">destURLs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">AltimeterDestination</span><span class="p">(</span><span class="s2">&#34;index&#34;</span><span class="p">,</span> <span class="s2">&#34;/&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">config</span><span class="p">.</span><span class="nx">dir</span> <span class="o">=</span> <span class="s2">&#34;dist/preview&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">writeFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&#34;config.json&#34;</span><span class="p">),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then you can run it with <code>altimeter config.json</code> and it will start taking the screenshots and saving them into the specified folder.</p>
<a class="anchor" href="#meta--tags">
    <h2 id="meta--tags">
        <span class="text"><code>&lt;meta /&gt;</code> tags</span>
        <span class="tag">#</span>
    </h2>
</a>
<p>To actually make the images show up when your web page is linked, you need to add the appropriate meta tags depending on which social media you want the image to be fetched and displayed.</p>
<a class="anchor" href="#open-graph-protocol">
    <h3 id="open-graph-protocol">
        <span class="text">Open Graph Protocol</span>
        <span class="tag">#</span>
    </h3>
</a>
<p><a href="https://ogp.me/">Open Graph Protocol</a> is used on many web services (including Facebook, LinkedIn, Mastodon) to fetch the preview image so you need to add the followings onto your site within the <code>&lt;head&gt;</code> element. You can also (optionally) specify the image width and height. From my personal experience, it doesn&rsquo;t matter if they are absolute or relative path as they seem to work either way.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">&#34;og:image&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;preview/automated_link_preview.jpg&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">&#34;og:image:height&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;600&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">property</span><span class="o">=</span><span class="s">&#34;og:image:width&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;1200&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><a class="anchor" href="#twitter">
    <h3 id="twitter">
        <span class="text">Twitter</span>
        <span class="tag">#</span>
    </h3>
</a>
<p>Twitter has its <a href="https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/markup">own documentation</a> for the display card. At the time of writing, it seems like they only take absolute path, relative paths don&rsquo;t seem to work as intended.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;twitter:card&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;summary_large_image&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;twitter:image&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;https://binhong.me/blog/preview/automated_link_preview.jpg&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You can use <a href="https://cards-dev.twitter.com/validator">this card validator</a> built by Twitter to try if your newly set <code>&lt;meta /&gt;</code> tags are getting picked up. Unlike just tweeting it out on your profile and see how it work, this would always force fetch from the given link and overwrite whatever cache they already stored of the link.</p>
<a class="anchor" href="#google">
    <h3 id="google">
        <span class="text">Google</span>
        <span class="tag">#</span>
    </h3>
</a>
<p>Honestly, I couldn&rsquo;t find a good documentation on how to go about setting the image properly. I only found <a href="https://developers.google.com/search/docs/advanced/robots/robots_meta_tag#max-image-preview">this</a> about setting the <code>max-image-preview</code> but nowhere does it say how to tell Google which image to use. I looked into how some of the news websites does it instead. NYTimes uses the <code>image</code> tag as below. The Verge seems to use some sort of <a href="https://schema.org/">Schema.org</a> setup but within a <code>&lt;script /&gt;</code> tag (instead of <code>&lt;meta /&gt;</code>) and label it as <code>application/ld+json</code> type. I also checked GitHub (since they actually do one of these screenshot as preview image stuff really well) but I didn&rsquo;t see any <code>&lt;meta /&gt;</code> tag that stood out.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;robots&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;max-image-preview:large&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;image&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;https://binhong.me/threads/preview/index.jpg&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><a class="anchor" href="#github-action">
    <h2 id="github-action">
        <span class="text">GitHub Action</span>
        <span class="tag">#</span>
    </h2>
</a>
<p>I currently use the above package as a CLI on my own blog (specifically this one that you&rsquo;re reading right now). I didn&rsquo;t want to have to run a bunch of things manually everytime I write a new post before I deploy so instead, I &ldquo;delegated&rdquo; this part of the job to GitHub Action.</p>
<ol>
<li>Add the generated directory to .gitignore</li>
<li>Use Node.js in the GitHub Action (<code>- uses: actions/setup-node@v1</code>)</li>
<li>Make sure the devserver site is up and running (in my case, <code>hugo serve -D</code>)</li>
<li>Run <code>npm install</code></li>
<li>Run <code>npx altimeter config.json</code></li>
<li>Run build if needed (<code>hugo --buildFuture</code>)</li>
<li>Deploy! üéâ</li>
</ol>
<p><em>Note: If you are generating this for static content, you might need to setup a server to serve up those static content on a <code>localhost</code> address. I recommend following <a href="https://nodejs.org/en/knowledge/HTTP/servers/how-to-serve-static-files/">this guide</a> to set up a server (instead of using <code>expressjs</code>).</em></p>
<a class="anchor" href="#wrap-up">
    <h2 id="wrap-up">
        <span class="text">Wrap up</span>
        <span class="tag">#</span>
    </h2>
</a>
<p>This was a fun ride. Honestly, I ran into a few problems here and there (mainly, setting up monorepo in GlobeTrotte and creating CLI with TypeScript) but it&rsquo;s relatively straightforward otherwise. The actual coding part took less than a day while writing up the documentations (and this blog post) probably took close to double the time.</p>
</div>
          <div class="tags">
            üîñ
            <a style="border-radius: 5px; border-style: solid; border-width: 1px;" class="tag" href="https://binhong.me/blog/tags/preview">Preview</a>
            <a style="border-radius: 5px; border-style: solid; border-width: 1px;" class="tag" href="https://binhong.me/blog/tags/automation">Automation</a>
            <a style="border-radius: 5px; border-style: solid; border-width: 1px;" class="tag" href="https://binhong.me/blog/tags/typescript">TypeScript</a>
            <a style="border-radius: 5px; border-style: solid; border-width: 1px;" class="tag" href="https://binhong.me/blog/tags/link">Link</a>
          </div>
        </div>        <div class="newsletter">
          <h2>Subscribe to the newsletter today!</h2>
          <form action="https://binhong.me/newsletter/subscribe" method="post">
              <input type="email" name="email" placeholder="email@domain.com"/>
              <noscript>
                <br />
                <label>You will need to manually get this secret from <a href="https://binhong.me/newsletter/secret">here</a></label>
                <input name="secret" placeholder="secret"/>
                <br />
              </noscript>
              <input type="hidden" name="secret" id="secret" value="123potato123"/>
              <button type="submit" name="submit" class="subscribe">Subscribe</button>
          </form>
          You can also checkout previous issues <a href="https://binhong.me/newsletter" target="_blank" style="text-decoration: underline;">here</a> before deciding.
        </div>
        <div class="bottom_buttons">
          
          
          
          <a href="/blog/2025-04-25-self-hosted-github-runners/">
            <div class="bottom_button">
              ‚Üê Next
              <br />
              <br />
              <span class="button_title">Self-Hosted GitHub Actions Runners</span>
            </div>
          </a>
          
          
          
          <a href="/blog/2022-01-31-rebuild-personal-site/">
            <div class="bottom_button previous_post">
              Previous ‚Üí
              <br />
              <br />
              <span class="button_title">Rebuilding Personal Site from Scratch</span>
            </div>
          </a>
          
        </div>
      </main>
    </article>
      <footer class="content">
        <div class="footer primary_block">
          <div class="row">
            <p>Fonts:</p>
            <a href="http://vollkorn-typeface.com/" rel="noopener noreferrer nofollow" target="_blank" class="name">Vollkorn</a>,
            <a href="https://rubjo.github.io/victor-mono/" rel="noopener noreferrer nofollow" target="_blank" class="name">Victor Mono</a>
          </div>
          <div class="row">
            <p>
              <a href="https://github.com/binhonglee/blog/blob/main/content/2022-05-31-automated-link-preview-image.md?plain=1" rel="noopener noreferrer nofollow" target="_blank">Source</a>
              |
              <a rel="alternate" type="application/rss+xml" href="https://binhong.me/blog/index.xml" title="BinHong Lee&#39;s Blog">RSS</a>
            </p>
          </div>
          <div class="row">
            <p>
              &copy; 2025 <a href="https://binhong.me">BinHong Lee</a>
            </p>
          </div>
          <div class="row">
            <p>
              Powered by <a href="https://gohugo.io/" rel="noopener noreferrer nofollow" target="_blank">Hugo</a>
            </p>
          </div>
        </div>
      </footer>
    </div>
    <script type="text/javascript" src="https://binhong.me/darkMode.js"></script>
    <script type="text/javascript" src="https://binhong.me/viewer.js"></script>
    <script type="text/javascript" src="https://binhong.me/blog/secret.js"></script>
  </body>
</html>

